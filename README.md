# Linux_Network_Programming

---

#### [소켓프로그래밍](https://github.com/KimUJin3359/Linux_Network_Programming/tree/master/socket)
- 서버와 클라이언트가 서로 Read, Wirte
- 클라이언트가 종료되도 서버는 꺼지지 않음
- 클라이언트가 다시 접속하면 채팅이 이뤄짐
- 서버를 끄면 클라이언트도 종료

---
### Network 기본
#### 인터넷 원리
- Network
  - Net : 그물
  - 노드와 링크로 구성된 데이터 교환망
    - 노드 : 컴퓨팅 장치들
    - 링크 : 연결
- IP 주소
  - 노드들의 고유 ID
  - IPv4, IPv6
- 공유기(라우터)의 사용
  - PC끼리 연결하지 않고, 공유기를 거쳐 연결
  - 연결 PC가 늘어나도, 사용하는 랜카드는 PC당 1개
- 케이블
  - STP Cable
    - UTP : Unshieleded Twisted-Pair
    - STP : Shielded Twisted-Pair
    - EMI 방지를 위한 호일을 한번 더 감은 고급 케이블
  - UTP Cable
    - 다이렉트 케이블
    - 크로스 케이블
    - 잘못 사용하면 통신이 안됨
    - Auto MDI : 아무 케이블만 꽂아도, 잘 동작하는 기술(임베디드 보드들은 미지원)
    - PC, PC 등 동일 기종 간에는 크로스 케이블
    - PC와 Router 등 이기종 간에는 다이렉트 케이블
  - 동축케이블
  - 광(섬유)케이블
    - 빛 굴절을 이용하요, 선이 꺾이더라도 직진성으로 전달
  - 전송 스펙
    - CAT5e : 1Gbps, 100MHz 대역폭
    - CAT6 : 1Gbps, 250MHz 대역폭
    - CAT7 : 10Gbps, 600MHz 대역폭

#### 서버와 DNS

![그림](https://user-images.githubusercontent.com/50474972/114398417-bcf0b700-9bda-11eb-8692-59c68114fe30.JPG)

- 인터넷의 발전
  - 어떠한 한 공유폴더를 공유하여 사용했음
    - 해당 공유폴더를 가지고 있는 컴퓨터가 종료하면, 다른 작업을 하지 못함
    - 공용 컴퓨터(서버, 24시간 계속 켜두는 컴퓨터)를 둬서 위의 문제를 해결
- 인터넷의 창시자
  - 팀 버너스리
  - www(world wide web) : 가장 거대한 네트워크
  - w3c : www의 협회장
  - HTML 문서의 규격을 만듬
  - HTML 문서를 읽어내는 것 : 웹 브라우저
  - 해당 서버에 접속하려면 서버의 IP주소를 입력
- 렌더링
  - 소스코드(java script)를 가져와 빌드하여 보여주는 것
  - 브라우저를 렌더링 머신이라고도 함
- DNS(Domain Name System)
  - 사람이 이해하기 쉬운 도메인 주소를 IP로 변환
  - 인터넷상의 전화번호부  

#### 네트워크 분류
- 규모에 따른 분류
  - LAN(Local Area Network)
    - 랜카드 : 근거리 통신망을 위한 네트워크 카드
    - 랜케이블 : 근거리 통신망 용 케이블
    - 집안 / 사무실 / 소규모 공장 수준
    - Ethernet 방식으로 사용하는 소규모 네트워크
  - WAN(Wild Area Network)
    - LAN보다 넓은 네트워크를 의미
  - 인터넷
    - 가장 거대한 네트워크
    - ISP(Internet Service Provider) 업체 신청하여, 전용선 + IP를 사용
- Cell : 무선 이동통신을 위해 하나의 기지국이 포괄하는 범위
- Cellular
  - 한 지역을 여러개의 셀로 분할하여 운용하는 통신 방식
  - 주파수를 알뜰하게 쓰기 위함
  - 주파수 대역 : 사람의 수에 따라 대역폭이 많이 필요함
- IoT
  - 무선 네트워크가 Default 통신 방식
  - 네트워크 규모, 특징에 따라 필요한 속도, 가격 존재
    - 무선 LAN : Wifi/BLE
    - 실외 : Cellular - LTE/5G
    - 무선 WAN(LowerPowerWAN) : 낮은 전력으로 넓은 범위에서 쓸 수 있는 방법

### 프로토콜의 이해
- 프로토콜 : 통신의 약속
  - 통신의 두 주체가 같은 프로토콜을 쓴다면, 약속된 규칙으로 통신이 가능
  - HW : 장비 규칙, 신호 전달 속도
  - Format : 신호의 형태
  - Sequence : Handshake 방식, 신호 전달 순서
  - SW 동작 : 오류 검출을 위한 행동
- 프로토콜을 이해해야 하는 이유
  - 완벽한 통신 Application 제작 가능
  - 통신 App을 위한 Library 제작 가능
  - 프로토콜 내용대로 수행하는 Server 구축 가능

#### TCP/IP
- IP(Internet Protocol)
  - 송신 호스트와 수신 호스트가 정보를 주고받는데 사용하는 규약
  - 패킷 혹은 데이터그램이라고 하는 덩어리로 나뉘어 전송
  - 비 연결성
    - 패킷을 받을 대상이 없거나 해당 도착지의 주소가 불능 상태여도 패킷을 전송
  - 비 신뢰성
    - 통신 도중 패킷이 사라질 수 있음
    - 패킷이 순서대로 도착하지 않을 수 있음
  - IP Address : 인터넷 상에 있는 컴퓨터의 고유한 주소

```
이더넷(LAN) : CSMA/CD 사용, MAC주소를 통한 정보 공유
인터넷 : TCP/IP 사용, IP Address를 통한 정보 공유
TCP/IP 사용 시 라우터가 길을 미리 세팅(라우팅 : MST)
```

- TCP(Transmission Control Protocol)
  - 전송 제어 프로토콜
  - IP의 핵심 프로토콜 중 하나
  - 연결 지향(3way handshake)
  - 데이터 전달 보증
  - 순서 보증
  - 신뢰할 수 있는 프로토콜
- UDP(User Datagram Protocol)
  - 데이터 전달, 순서 보장 X
  - 속도가 빠름

#### Ethernet Cable
- 전송속도(bit rate)
  - bit per second(bps)
  - 초당 몇 bit를 전송하는지

  | UART 통신 | USB 통신 |
  | --- | --- |
  | 0.01MBps | 400MBps |
  | 느리다 | 빠름 |

- USB 통신을 쓰지 않는 이유
  - 엔지니어에게 USB는 어려움(개발시간, spec up)
  - 전력
- 대역폭
  - 주파수
    - 최대와 최소 주파수의 폭
    - 폭이 넓을수록 정보를 한꺼번에 실을 수 있는 양이 커짐
  - 통신
    - 한번에 데이터를 전송할 수 있는 양

### 서버의 이해
#### 서버의 구성
- Client들이 접속하여 쓸 수 있는 시스템
- 특징
  - 대부분 무중단 운영
  - 대용량 트래픽 처리
- 역할
  - 웹 서버 : Client들에게 HTTP 문서를 전달하는 서버
  - DB 서버 : Client들의 DB를 관리하는 서버
  - 게임 서버 : Client들의 게임 데이터를 관리, 처리해주는 서버
- 하나의 PC를 여러 역할의 서버(DB 서버, 파일 서버, 게임 서버)로 사용
  - 단점
    - 개인용 PC를 계속 켜두어야 함
    - 개인용 자료가 유출 될 수 있음
    - 개인 PC에서 게임을 돌리면, 모든 서버들 속도가 낮아짐
- 여러 역할을 하는 서버를 사용
  - 장점
    - 개인용 PC는 자유롭게 사용
  - 단점
    - 서버용 컴퓨터는 항상 켜둠
    - 누군가 파일 서버에서 다운로드를 받고 있으면, 웹이 먹통
- 모든 서버를 따로 시스템을 둠
  - 장점
    - 보안에 안전
    - 간섭으로 인한 속도 저하가 없음
  - 단점
    - 관리가 힘듦
- 핸드폰을 서버로 사용
 
#### 로드밸런싱
- 웹 서버 한대가 처리할 수 있는 트래픽
- 접속자가 많아지면 다음 문젤 성능 이슈 발생
  - 네트워크 회선 문제
  - SSD Read 성능 문제
- 웹 서버를 여러대 두고 분할로 접속하도록 구성하면 속도가 빨라짐
- 하나의 웹 서버가 죽었을 때, 무중단 운영이 가능

#### 클라우드
- 인터넷을 이용하여, 가상화된 시스템 리소스를 사용할 수 있는 것
  - 자신의 컴퓨터가 아닌, 서버 컴퓨터 자원을 사용하는 기술
  - 전산 운영 비용을 줄일 수 있음
    - 월 정기 : 서버 관리자 급여 / 전기비 / 사무실 임대료 / 회선 비용
    - 일시적 : L4 스위치 / 방화벽 / 랙 / 항온항습 장치 / UPS 등
- Auto Scailing
  - 장비 없이 장비 세팅이 편함 : 로드 밸런싱이 몇 번의 클릭으로 이루어짐
  - 서버의 개수가 자동으로 조절 설정 가능
    - 트래픽이 많아지면, 서버의 수가 늘어남
- 전산실 운영
  - 적정 온도, 습도 유지
    - 항온 항습 시스템
    - 공기 여과기 등
  - UPS 설치
    - 비상 전력 시스템
  - 물리적 보안
  - 서버 관리자
  - 서버 랙
    - 안정적인 전원 공급
    - 먼지 관리
- 코로케이션(IDC 입주 서비스)
  - 전산실 필수 도구 구비완비 : 전기비, 빠른 전용선, 안정적 전력
  - 추가서비스 : 방화벽, 위탁운영, 백업 서비스
- 서버실 운영 문제점
  - 특정 일에만 트래픽이 몰리는 경우
- 가상화 기술
  - 한 대의 고성능 컴퓨터에서 시뮬레이션 SW 컴퓨터를 생성
  - 시뮬레이션 환경이지만, 실제 컴퓨터와 똑같이 동작
  - 사용자는 시뮬레이션인지 실제 컴퓨터인지 구분이 어려움

#### IaaS
- Infrastructure as a Service
- 컴퓨팅 시스템을 가상화 환경으로 만들어, 서비스를 제공

#### PaaS
- Platform as a Service
- 바꿀 없는 기본 시스템이 구축되어 있는 상태에서 App 개발/ 배포/ DB 관리 등 가능한 상태의 시스템

#### SaaS
- Software as a Service
- 서버에서 호스팅 방식으로 서비스 제공

#### 인증 팩터
- 인증할 수 있는 요소
  - 지식 기반 Factor : Password
  - 소유 기반 Factor : OTP, 키파일, 공인인증서
- 인증 개수
  - SFA(싱글 팩터 인증)
  - 2FA(투 팩터 인증)
  - MFA(멀티 팩터 인증)
- Hash(Cryptographic Hash Function)
  - 입력시 예측할 수 없는 암호화된 데이터가 나옴
  - Encoding은 가능하지만, Decoding은 불가
  - 원본 값 한 글자만 바뀌어도, 예측 불가한 숫자가 나옴
  - 같은 코드값이 나올 확률이 매우 희박
  - 사용
    - 파일 무결성 검사
    - 스니핑(도청) 방지
- 암호화 방식
  - SHA-2
    - Hash를 사용한 암호화
    - 디코딩을 할 수 없음
  - RSA
    - 공개키, 개인키로 암호화 하는 방식
    - 개인키가 있으면 디코딩을 할 수 있음

### Socket 통신 개요
- Socket : TCP/IP 통신을 하기위한 SW 객체
- Socket의 Interface만 맞추면 통신 가능
  - TCP/UDP
  - IP/OORT
- Linux Kernel은 Socket을 파일로 관리

#### 통신 조건
- Server와 Client 모두 Socket 객체를 생성해서 서로 연결 필요
- 상대방의 IP주소와 Port 번호를 알고 있어야 함
  - 한 Port 당 하나의 소켓 통신이 가능
  - 하나의 Host에서 동시에 여러 소켓 통신을 할 수 있도록 여러 Port를 지원
    - 개인적으로 사용하는 Port는 기본적으로 막혀있음
    - Port 방화벽을 열어야 함

#### 방화벽 허용
- iptables -I INPUT '숫자' -p tcp --dport '포트번호' -j ACCEPT
  - -I 옵션 : 인바운드 설정, 규칙 #'숫자'번
  - -p 옵션 : tcp, ip 설정
  - --dport 옵션 : 몇 번 포트를 설정할지 결정
  - -j 옵션 : 처리를 ACCEPT할지 DENY할지 결정
- 확인 방법
  - ping
  - nc
    - nc -l '포트번호' : 메세지 서버를 엶
    - nc 'IP주소' '포트번호' : 메세지 서버에 접속 
